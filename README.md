# Pardano Node.js Module

[![N|Solid](https://pardano.com/images/logo.png)](https://pardano.com)

Pardano is an Iranian website that provides online billing services and this module, helps you to use Pardano.ir Soap webservice easily and quickly in Node.js.

پردانو یک وبسایت ارائه کننده خدمات پرداخت آنلاین است و این پکیج (ماژول) به شما کمک میکند به راحتی و به سرعت از وب سرویس پردانو در ند جی اس استفاده کنید. این پکیج به سفارش وبسایت پردانو نوشته شده است.

# نحوه ی نصب

نصب این پکیج نیز مانند دیگر پکیج ها با استفاده از ان پی ام صورت میگیرد:

```sh
$ npm install pardano --save
```
با اجرای دستور فوق، پکیج پردانو به پروژه شما اضافه خواهد شد.

# نحوه ی استفاده

ابتدا شما میبایست یک شی از این پکیج ایجاد کنید:

```js
const Pardano = require('pardano');
const payment = new Pardan('ای پی آی درگاه شما');
```
حال از طریق ثابت پیمنت به دو متد این پکیج دسترسی خواهید داشت.

# متد های پکیج

با استفاده از دو متد زیر میتوانید کاربر را به درگاه پرداخت هدایت و پس از بازگشت کاربر از درگاه، از وضعیت پرداخت مطلع شوید:

## متد sendRequest
این متد جهت ایجاد لینک پرداخت استفاده میشود:
```js
app.get('/pardano', function (req, res) {
    payment.sendRequest(100, 'http://website.ir/pardano/verify', 1500, 'Description', function(err, link){
        if(err)
          res.end(err);
        else
          res.end("<html><body><a href='"+link+"'>Click to redirect</a></body></html>");
    });

});
```
پارامتر اول مقدار و قیمت میباشد که باید بصورت تومان و عددی وارد شود.

پارامتر دوم آدرس بازگشت است. کاربر پس از انجام یا لغو تراکنش به این آدرس هدایت خواهد شد.

پارامتر سوم شماره سفارش یا فاکتور میباشد که باید بصورت عددی وارد شود.

پارامتر چهارم اطلاعات اضافی یا توضیحات تراکنش است.

پارامتر پنجم نیز تابع کال بک است که دو ورودی ارور و لینک به آن پاس داده میشود. در صورتی مشکلی در ایجاد لینک پرداخت وجود داشته باشد متن آن در این پارامتر ورودی موجود است، در غیر این صورت با مقدار نال پر میشود. پارامتر ورودی دوم نیز لینک پرداخت است، در صورتی که عملیات ایجاد لینک بدون مشکل باشد، این ورودی حاوی لینک پرداخت میباشد. در غیر این صورت با نال پر میشود.

## متد verifyRequest

جهت بررسی وضعیت تراکنش پس از بازگشت کاربر از درگاه بانکی به صفحه بازگشتی تعریف شده در متد ایجاد لینک، استفاده میشود:

```js
app.get('/pardano/verify', function(req, res){
    payment.verifyRequest(req, 100, function(success, message){
        if(success)
          res.end("Successfull");
        else
          res.end(message);
    });
});
```

پارامتر اول این متد، آبجکت ریکوئست میباشد. این پارامتر جهت بررسی کد رهگیری تراکنش دریافت میشود.

پارامتر دوم قیمت است که در هدایت کاربر به درگاه بانکی استفاده کردید.

پارامتر سوم تابع کال بک میباشد که شامل دو ورودی است. ورودی اول دارای مقدار بولین میباشد که مشخص میکند تراکنش موفقیت آمیز بوده است یا نه. در صورتی که تراکنش موفقیت آمیز نبوده باشد، پارامتر دوم شامل متن خطاست. در غیر این صورت این ورودی با نال پر میشود.

# نمونه کد

در این مخزن نیز فایلی با نام sample.js قرار دارد که شامل کد نمونه استفاده از این پکیج است.

# LICENSE - مجوز استفاده

This package is under Apache 2.0 license.

این پکیج با رعایت بند های مجوز Apache 2.0 قابل استفاده و توسعه میباشد.